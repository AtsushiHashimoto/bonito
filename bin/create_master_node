cd `dirname $0`
. ../bonito.conf

kubeadm init --pod-network-cidr=$BONITO_POD_NETWORK_CIDR
token=$(kubeadm token generate)
kubeadm token create ${token} --print-join-command --ttl=0 > $BONITO_BIN_JOIN
chmod a+x $BONITO_BIN_JOIN

cp /etc/kubernetes/admin.conf $BONITO_K8S_CONFIG
chown $(id -u):$(id -g) $BONITO_K8S_CONFIG
export KUBECONFIG=$BONITO_K8S_CONFIG

for daemon in $BONITO_K8S_DAEMONSET; do
  echo kubectl create -f $daemon
done
